output "policy_id" {
  description = "The ID of the SCP policy"
  value       = aws_organizations_policy.deny_public_access.id
}

output "policy_arn" {
  description = "The ARN of the SCP policy"
  value       = aws_organizations_policy.deny_public_access.arn
}

output "policy_name" {
  description = "The name of the SCP policy"
  value       = aws_organizations_policy.deny_public_access.name
}

output "policy_content" {
  description = "The JSON content of the SCP policy"
  value       = aws_organizations_policy.deny_public_access.content
  sensitive   = false
}

output "attached_target_ids" {
  description = "List of target IDs where the policy is attached"
  value       = var.target_ids
}

output "attachment_ids" {
  description = "Map of target IDs to their attachment IDs"
  value = {
    for k, v in aws_organizations_policy_attachment.attach_to_targets : k => v.id
  }
}

output "enabled_controls" {
  description = "Summary of enabled SCP controls"
  value = {
    deny_ec2_public_ip            = var.deny_ec2_public_ip
    deny_elastic_ip_operations    = var.deny_elastic_ip_operations
    deny_public_security_groups   = var.deny_public_security_groups
    deny_internet_facing_lb       = var.deny_internet_facing_lb
    deny_lb_in_public_subnets     = var.deny_lb_in_public_subnets
    deny_s3_public_access_changes = var.deny_s3_public_access_changes
    total_statements              = length(local.policy_statements)
  }
}
